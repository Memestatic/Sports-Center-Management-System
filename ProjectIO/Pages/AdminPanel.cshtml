@page
@model AdminPanel
@{
    ViewData["Title"] = "AdminPanel";
}
@* <!-- @if (Model.Permissions == 1) {} --> *@
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>

@if (!string.IsNullOrEmpty(Model.alertMessage))
{
    <div class="alert alert-danger text-center" role="alert">
        @Model.alertMessage
    </div>
}

@if (!string.IsNullOrEmpty(Model.confirmMessage))
{
    <div class="alert alert-success text-center" role="alert">
        @Model.confirmMessage
    </div>
}

<nav>
    <div class="nav nav-tabs" id="nav-tab" role="tablist">
        <button class="nav-link" id="nav-sportscenter-tab" data-bs-toggle="tab" data-bs-target="#nav-sportscenter" type="button" role="tab" aria-controls="nav-sportscenter" aria-selected="false">Sports Center</button>
        <button class="nav-link" id="nav-sportsobject-tab" data-bs-toggle="tab" data-bs-target="#nav-sportsobject" type="button" role="tab" aria-controls="nav-sportsobject" aria-selected="false">Sports Object</button>
        <button class="nav-link" id="nav-users-tab" data-bs-toggle="tab" data-bs-target="#nav-users" type="button" role="tab" aria-controls="nav-users" aria-selected="false">Users</button>
        <button class="nav-link" id="nav-workers-tab" data-bs-toggle="tab" data-bs-target="#nav-workers" type="button" role="tab" aria-controls="nav-workers" aria-selected="false">AssignedWorkers</button>
        <button class="nav-link" id="nav-price-tab" data-bs-toggle="tab" data-bs-target="#nav-price" type="button" role="tab" aria-controls="nav-price" aria-selected="false">Pricing</button>
        <button class="nav-link" id="nav-passes-tab" data-bs-toggle="tab" data-bs-target="#nav-passes" type="button" role="tab" aria-controls="nav-passes" aria-selected="false">passes</button>
        <button class="nav-link" id="nav-reservations-tab" data-bs-toggle="tab" data-bs-target="#nav-reservations" type="button" role="tab" aria-controls="nav-reservations" aria-selected="false">Reservations</button>
        <button class="nav-link" id="nav-workerSession-tab" data-bs-toggle="tab" data-bs-target="#nav-workerSession" type="button" role="tab" aria-controls="nav-workerSession" aria-selected="false">Worker Sessions</button>
    </div>
</nav>
<div class="tab-content" id="nav-tabContent">
    <!--SPORTSCENTER-TAB------------------------------------------------------------------------------------------------->
    <div class="tab-pane fade" id="nav-sportscenter" role="tabpanel" aria-labelledby="nav-sportscenter-tab" tabindex="0">
        <div class="text-center mb-3">
            <button type="button" class="btn btn-success" data-bs-toggle="collapse" data-bs-target="#addForm-Model.SportsCenterId">Add New Record</button>
        </div>
        <div id="addForm-Model.SportsCenterId" class="collapse">
            <!-- Form for adding new records -->
            <form method="post" asp-page-handler="Add" class="text-center">
                <div class="form-group">
                    <label>Nazwa Ośrodka:</label>
                    <input type="text" name="Name" class="form-control" required />
                </div>
                <div class="form-group">
                    <label>Ulica:</label>
                    <input type="text" name="Street" class="form-control" required />
                </div>
                <div class="form-group">
                    <label>Numer Ulicy:</label>
                    <input type="text" name="StreetNumber" class="form-control" required />
                </div>
                <div class="form-group">
                    <label>Miasto:</label>
                    <input type="text" name="City" class="form-control" required />
                </div>
                <div class="form-group">
                    <label>Województwo:</label>
                    <input type="text" name="State" class="form-control" required />
                </div>
                <div class="form-group">
                    <label>Kod Pocztowy:</label>
                    <input type="text" name="ZipCode" class="form-control" required />
                </div>
                <button type="submit" class="btn btn-success mt-2">Add</button>
            </form>
        </div>
        <br>

        @if (Model.SportsCenters != null && Model.SportsCenters.Count > 0)
        {
            <table class="table table-striped table-bordered table-hover text-center">
                <thead class="thead-dark">
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Street</th>
                        <th>Street Number</th>
                        <th>City</th>
                        <th>State</th>
                        <th>Zip Code</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var center in Model.SportsCenters)
                    {
                        <tr>
                            <td>@center.SportsCenterId</td>
                            <td>@center.Name</td>
                            <td>@center.Street</td>
                            <td>@center.StreetNumber</td>
                            <td>@center.City</td>
                            <td>@center.State</td>
                            <td>@center.ZipCode</td>
                            <td>
                                <div class="d-flex justify-content-center">
                                    <!-- Edit button -->
                                    <button type="button" class="btn btn-warning btn-sm mx-1" data-toggle="collapse" data-target="#editForm-@center.SportsCenterId">Edit</button>
                                    <!-- Delete button -->
                                    <button type="button" class="btn btn-danger btn-sm mx-1" data-bs-toggle="modal" data-bs-target="#confirmDeleteModal-@center.SportsCenterId">Delete</button>
                                </div>
                            </td>
                        </tr>

                        <!-- Edit form -->
                        <tr id="editForm-@center.SportsCenterId" class="collapse">
                            <td colspan="8">
                                <form method="post" asp-page-handler="Edit" asp-route-id="@center.SportsCenterId">
                                    <div class="form-group">
                                        <label>Nazwa Ośrodka:</label>
                                        <input type="text" name="Name" value="@center.Name" class="form-control" required />
                                    </div>
                                    <div class="form-group">
                                        <label>Ulica:</label>
                                        <input type="text" name="Street" value="@center.Street" class="form-control" required />
                                    </div>
                                    <div class="form-group">
                                        <label>Numer Ulicy:</label>
                                        <input type="text" name="StreetNumber" value="@center.StreetNumber" class="form-control" required />
                                    </div>
                                    <div class="form-group">
                                        <label>Miasto:</label>
                                        <input type="text" name="City" value="@center.City" class="form-control" required />
                                    </div>
                                    <div class="form-group">
                                        <label>Województwo:</label>
                                        <input type="text" name="State" value="@center.State" class="form-control" required />
                                    </div>
                                    <div class="form-group">
                                        <label>Kod Pocztowy:</label>
                                        <input type="text" name="ZipCode" value="@center.ZipCode" class="form-control" required />
                                    </div>
                                    <button type="submit" class="btn btn-primary">Save Changes</button>
                                </form>
                            </td>
                        </tr>

                        <!-- Delete modal -->
                        <div class="modal fade" id="confirmDeleteModal-@center.SportsCenterId" tabindex="-1" aria-labelledby="confirmDeleteModalLabel-@center.SportsCenterId" aria-hidden="true">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title" id="confirmDeleteModalLabel-@center.SportsCenterId">Confirm Deletion</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        Are you sure you want to delete this item?
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                        <form method="post" asp-page-handler="Delete" asp-route-id="@center.SportsCenterId" style="display:inline;">
                                            <button type="submit" class="btn btn-danger">Delete</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                </tbody>
            </table>
        }
        else
        {
            <p class="text-muted text-center">Brak danych o obiektach.</p>
        }
    </div>


    <!--SPORTSOBJECT/FACILITY-TAB---------------------------------------------------------------------------------------->
    <div class="tab-pane fade" id="nav-sportsobject" role="tabpanel" aria-labelledby="nav-sportsobject-tab" tabindex="0">

        <!-- ADD NEW RECORD FORM -->
        <button type="button" class="btn btn-success" data-bs-toggle="collapse" data-bs-target="#addForm-Model.FacilityId">Add New Record</button>
        <div id="addForm-Model.FacilityId" class="collapse">
                    <form method="post" asp-page-handler="AddF">
                        <div class="form-group">
                            <label>Nazwa Obiektu:</label>
                            <input type="text" name="FacilityName" value="" class="form-control" required />
                        </div>
                        <div class="form-group">
                            <label for="facilityType">Typ Obiektu:</label>
                            <select name="TypeName" id="facilityType" class="form-control" required>
                                <option value="">Wybierz typ obiektu</option>
                                @if (Model.FacilityTypes != null && Model.FacilityTypes.Count > 0)
                                {
                                    @foreach (var type in Model.FacilityTypes)
                                    {
                                        <option value="@type.TypeName">@type.TypeName</option>
                                    }
                                }
                            </select>
                </div>
                <div class="form-group">
                    <label for="centerName">Nazwa Ośrodka:</label>
                    <select name="Name" id="centerName" class="form-control" required>
                        <option value="">Wybierz ośrodek</option>
                        @if (Model.SportsCenters != null && Model.SportsCenters.Count > 0)
                        {
                            @foreach (var center in Model.SportsCenters)
                            {
                                <option value="@center.Name">@center.Name</option>
                            }
                        }
                    </select>
                </div>
                <div class="form-group">
                    <label for="promoRate">Cena [zł]:</label>
                    <input type="number" id="Price" name="Price" class="form-control" required step="0.01" min="0" placeholder="np. 40">
                </div>
                <div class="form-group">
                    <label>Przebieralnia:</label>
                    <input class="form-check-input" type="checkbox" id="isChangingRoomAvailable" name="IsChangingRoom" value="true">
                </div>
                <div class="form-group">
                    <label for="isEquipmentAvailable">Pełne wyposażenie:</label>
                    <input class="form-check-input" type="checkbox" id="isEquipmentAvailable" name="IsEquipment" value="true">
                </div>
                <div class="form-group">
                    <label for="promoStart">Data rozpoczęcia promocji:</label>
                    <input type="date" id="promoStart" name="PromoStart" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="promoEnd">Data zakończenia promocji:</label>
                    <input type="date" id="promoEnd" name="PromoEnd" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="promoRate">Wartość promocji [%]:</label>
                    <input type="number" id="promoRate" name="PromoRate" class="form-control" required step="0.01" min="0" placeholder="Wprowadź wartość np. 25 dla 25%">
                </div>
                <button type="submit" class="btn btn-success">Add</button>
            </form>
        </div>


        <br>
        @if (Model.Facilities != null && Model.Facilities.Count > 0)
        {
            @foreach (var facility in Model.Facilities)
            {
                <tr>
                    <td>@facility.FacilityId</td>
                    <td>@facility.FacilityName</td>
                    <td>@facility.FacilityType.TypeName</td>
                    <td>@facility.FacilitySportsCenter.Name</td>
                    <td>@facility.Price</td>
                    <td>@facility.IsChangingRoom</td>
                    <td>@facility.IsEquipment</td>
                    <td>@facility.PromoStart</td>
                    <td>@facility.PromoEnd</td>
                    <td>@facility.PromoRate</td>
                
                <!-- DELETE BUTTON -->
                <button type="button" class="btn btn-danger" data-mdb-ripple-init data-bs-toggle="modal" data-bs-target="#confirmDeleteModalF-@facility.FacilityId">Delete</button>

                <!-- POPUP CONFIRM MENU -->
                <div class="modal fade" id="confirmDeleteModalF-@facility.FacilityId" tabindex="-1" aria-labelledby="confirmDeleteModalLabelF-@facility.FacilityId" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="confirmDeleteModalLabelF-@facility.FacilityId">Confirm Deletion</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                Are you sure you want to delete this item?
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                <form method="post" id="deleteForm-@facility.FacilityId" asp-page-handler="DeleteF" asp-route-id="@facility.FacilityId" style="display:inline;">
                                    <button type="submit" id="confirmDeleteButtonF-@facility.FacilityId" class="btn btn-danger">Delete</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

                <button type="button" class="btn btn-warning" data-toggle="collapse" data-target="#editForm-@facility.FacilityId">Edit</button>
                <div id="editForm-@facility.FacilityId" class="collapse">
                    <form method="post" asp-page-handler="EditF" asp-route-id="@facility.FacilityId">
                        <div class="form-group">
                            <label>Nazwa Obiektu:</label>
                            <input type="text" name="FacilityName" value="@facility.FacilityName" class="form-control" required />
                        </div>
                        <div class="form-group">
                            <label for="facilityType">Typ Obiektu:</label>
                                <select name="TypeName" id="facilityType" value="@facility.FacilityType.TypeName" class="form-control" required>

                                    <option value="@facility.FacilityType.TypeId" selected>
                                        @facility.FacilityType.TypeName
                                    </option>

                                    @if (Model.FacilityTypes != null && Model.FacilityTypes.Count > 0)
                                    {
                                        @foreach (var type in Model.FacilityTypes)
                                        {
                                            <option value="@type.TypeName">@type.TypeName</option>
                                            <option value="@type.TypeName">@type.TypeName</option>
                                        }
                                    }
                                </select>
                        </div>
                        <div class="form-group">
                            <label for="centerName">Nazwa Ośrodka:</label>
                            <select name="Name" id="centerName" value="@facility.FacilitySportsCenter.Name" class="form-control" required>

                                    <option value="@facility.FacilitySportsCenter.SportsCenterId" selected>
                                        @facility.FacilitySportsCenter.Name
                                    </option>

                                @if (Model.SportsCenters != null && Model.SportsCenters.Count > 0)
                                {
                                    @foreach (var center in Model.SportsCenters)
                                    {
                                        <option value="@center.Name">@center.Name</option>
                                    }
                                }
                            </select>
                        </div>
                            <div class="form-group">
                                <label for="promoRate">Cena [zł]:</label>
                                <input type="number" id="Price" name="Price" value="@facility.Price" class="form-control" required step="0.01" min="0" placeholder="np. 40">
                            </div>
                        <div class="form-group">
                            <label>Przebieralnia:</label>
                            <input class="form-check-input" type="checkbox" id="isChangingRoomAvailable" name="IsChangingRoom" @(facility.IsChangingRoom ? "checked" : "")>
                        </div>
                        <div class="form-group">
                            <label for="isEquipmentAvailable">Pełne wyposażenie:</label>
                            <input class="form-check-input" type="checkbox" id="isEquipmentAvailable" name="IsEquipment" value="true" @(facility.IsEquipment ? "checked" : "")>
                        </div>
                        <div class="form-group">
                            <label for="promoStart">Data rozpoczęcia promocji:</label>
                            <input type="date" id="promoStart" name="PromoStart" class="form-control" value="@facility.PromoStart.ToString("yyyy-MM-dd")" required>
                        </div>
                        <div class="form-group">
                            <label for="promoEnd">Data zakończenia promocji:</label>
                            <input type="date" id="promoEnd" name="PromoEnd" class="form-control" value="@facility.PromoEnd.ToString("yyyy-MM-dd")" required>
                        </div>
                        <div class="form-group">
                            <label for="promoRate">Wartość promocji [%]:</label>
                            <input type="number" id="promoRate" name="PromoRate" value="@facility.PromoRate" class="form-control" required step="0.01" min="0" placeholder="Wprowadź wartość np. 25 dla 25%">
                        </div>
                        <button type="submit" class="btn btn-primary-warning">Save Changes</button>
                    </form>
                </div>
                    <br />
                </tr>
            }
        }
        else
        {
            <p>Brak danych o obiektach.</p>
        }
        

    </div>
    <!--USERS-TAB-------------------------------------------------------------------------------------------------------->
    <div class="tab-pane fade" id="nav-users" role="tabpanel" aria-labelledby="nav-PassUsers-tab" tabindex="0">

        <!-- ADD NEW RECORD FORM -->
        <button type="button" class="btn btn-success" data-bs-toggle="collapse" data-bs-target="#addForm-Model.PassUserId">Add New Record</button>
        <div id="addForm-Model.PassUserId" class="collapse">
            <form method="post" asp-page-handler="AddUser">
                <div class="form-group">
                    <label>Name:</label>
                    <input type="text" name="PassUserName" value="" class="form-control" required />
                </div>
                <div class="form-group">
                    <label>SurName:</label>
                    <input type="text" name="PassUserSurName" value="" class="form-control" required />
                </div>
                <div class="form-group">
                    <label>Gender:</label>
                    <select name="PassUserGender" class="form-control" required>
                        <option value="77">Male</option>
                        <option value="70">Female</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Phone:</label>
                    <input type="text" name="PassUserPhone" value="" class="form-control" required />
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="text" name="PassUserEmail" value="" class="form-control" required />
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <input type="text" name="PassUserPassword" value="" class="form-control" required />
                </div>

                <button type="submit" class="btn btn-success">Add</button>
            </form>
        </div>
        <br>
        <!--LIST-VALUES-->
        @if (Model.Users != null && Model.Users.Count > 0)
        {
            @foreach (var user in Model.Users)
            {
                <tr>
                    <td>@user.UserId</td>
                    <td>@user.Name</td>
                    <td>@user.Surname</td>
                    <td>@user.DeclaredGender</td>
                    <td>@user.PhoneNumber</td>
                    <td>@user.Email</td>
                    <td>@user.Password</td>

                    <!-- DELETE BUTTON -->
                    <button type="button" class="btn btn-danger" data-mdb-ripple-init data-bs-toggle="modal" data-bs-target="#confirmDeleteModalU-@user.UserId">Delete</button>

                    <!-- POPUP CONFIRM MENU -->
                    <div class="modal fade" id="confirmDeleteModalU-@user.UserId" tabindex="-1" aria-labelledby="confirmDeleteModalLabelU-@user.UserId" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="confirmDeleteModalLabelU-@user.UserId">Confirm Deletion</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    Are you sure you want to delete this item?
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                    <form method="post" id="deleteForm-@user.UserId" asp-page-handler="DeleteUser" asp-route-id="@user.UserId" style="display:inline;">
                                        <button type="submit" id="confirmDeleteButtonU-@user.UserId" class="btn btn-danger">Delete</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!--EDIT BUTTON-->
                    <button type="button" class="btn btn-warning" data-toggle="collapse" data-target="#editForm-@user.UserId">Edit</button>

                    <!--POPUP-EDIT-FORM-->
                    <div id="editForm-@user.UserId" class="collapse">
                        <form method="post" asp-page-handler="EditUser" asp-route-id="@user.UserId">
                            <div class="form-group">
                                <label>Name:</label>
                                <input type="text" name="PassUserName" value="@user.Name" class="form-control" required />
                            </div>
                            <div class="form-group">
                                <label>SurName:</label>
                                <input type="text" name="PassUserSurName" value="@user.Surname" class="form-control" required />
                            </div>
                            <div class="form-group">
                                <label>Gender:</label>
                                <select name="PassUserGender" class="form-control" required>
                                    @if (user.DeclaredGender.ToString() == "Male")
                                    {
                                        <option value="77">Male</option>
                                        <option value="70">Female</option>
                                    }
                                    else
                                    {
                                        <option value="70">Female</option>
                                        <option value="77">Male</option>
                                    }
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Phone:</label>
                                <input type="text" name="PassUserPhone" value="@user.PhoneNumber" class="form-control" required />
                            </div>
                            <div class="form-group">
                                <label>Email:</label>
                                <input type="text" name="PassUserEmail" value="@user.Email" class="form-control" required />
                            </div>
                            <div class="form-group">
                                <label>Password:</label>
                                <input type="text" name="PassUserPassword" value="@user.Password" class="form-control" required />
                            </div>

                            <button type="submit" class="btn btn-primary-warning">Save Changes</button>
                        </form>
                    </div>

                    <br>
                </tr>
            }
        }
        else
        {
            <p>Brak danych o użytkownikach.</p>
        }
    </div>
    <!---------------------------------------------------------------------------------------------------->
    <div class="tab-pane fade" id="nav-workers" role="tabpanel" aria-labelledby="nav-workers-tab" tabindex="0">

        <!--ADD NEW RECORD FORM-->
        <button type="button" class="btn btn-success" data-bs-toggle="collapse" data-bs-target="#addForm-Model.WorkerId">Add New Record</button>
        <div id="addForm-Model.WorkerId" class="collapse">
            <form method="post" asp-page-handler="AddWorker">
                <div class="form-group">
                    <label>Function Type:</label>
                    <select name="workerFunction" class="form-control" required>
                        <option value="">Select worker function</option> 
                        @if (Model.WorkerFunctions != null && Model.WorkerFunctions.Count > 0)
                        {
                            @foreach (var func in Model.WorkerFunctions)
                            {
                                <option value="@func.WorkerFunctionId">@func.WorkerFunctionName</option>
                            }
                        }
                    </select>
                </div>
                <div class="form-group">
                    <label>Name:</label>
                    <input type="text" name="workerName" value="" class="form-control" required />
                </div>
                <div class="form-group">
                    <label>SurName:</label>
                    <input type="text" name="workerSurName" value="" class="form-control" required />
                </div>
                <div class="form-group">
                    <label>Gender:</label>
                    <select name="workerGender" class="form-control" required>
                        <option value="77">Male</option>
                        <option value="70">Female</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Phone:</label>
                    <input type="text" name="workerPhone" value="" class="form-control" required />
                </div>
                <div class="form-group">
                    <label>Email:</label>
                    <input type="text" name="workerEmail" value="" class="form-control" required />
                </div>
                <div class="form-group">
                    <label>Password:</label>
                    <input type="text" name="workerPassword" value="" class="form-control" required />
                </div>
                <button type="submit" class="btn btn-success">Add</button>
            </form>
        </div>
        <br>

        <!--LIST VALUES-->
        @if (Model.Workers != null && Model.Workers.Count > 0)
        {
            @foreach (var worker in Model.Workers)
            {
                <tr>
                    <td>@worker.WorkerId</td>
                    <td>@worker.AssignedWorkerFunction.WorkerFunctionName</td> 
                    <td>@worker.Name</td>
                    <td>@worker.Surname</td>
                    <td>@worker.DeclaredGender</td>
                    <td>@worker.PhoneNumber</td>
                    <td>@worker.Email</td>
                    <td>@worker.Password</td>

                    <!-- DELETE BUTTON -->
                    <button type="button" class="btn btn-danger" data-mdb-ripple-init data-bs-toggle="modal" data-bs-target="#confirmDeleteModalW-@worker.WorkerId">Delete</button>

                    <!-- POPUP CONFIRM MENU -->
                    <div class="modal fade" id="confirmDeleteModalW-@worker.WorkerId" tabindex="-1" aria-labelledby="confirmDeleteModalLabelW-@worker.WorkerId" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="confirmDeleteModalLabelW-@worker.WorkerId">Confirm Deletion</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    Are you sure you want to delete this item?
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                    <form method="post" id="deleteForm-@worker.WorkerId" asp-page-handler="DeleteAssignedWorker" asp-route-id="@worker.WorkerId" style="display:inline;">
                                        <button type="submit" id="confirmDeleteButtonW-@worker.WorkerId" class="btn btn-danger">Delete</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!--EDIT BUTTON-->
                    <button type="button" class="btn btn-warning" data-toggle="collapse" data-target="#editForm-@worker.WorkerId">Edit</button>

                    <!--POPUP-EDIT-FORM-->
                    <div id="editForm-@worker.WorkerId" class="collapse">
                        <form method="post" asp-page-handler="EditWorker" asp-route-id="@worker.WorkerId">
                            <div class="form-group">
                                <label>Function Type:</label>
                                <select name="workerFunction" class="form-control" required>

                                    <option value="@worker.AssignedWorkerFunction.WorkerFunctionId" selected>
                                        @worker.AssignedWorkerFunction.WorkerFunctionName
                                    </option>

                                    @* <option value="">Select worker AssignedAssignedWorkerFunction</option> *@
                                    @if (Model.WorkerFunctions != null && Model.WorkerFunctions.Count > 0)
                                    {
                                        @foreach (var func in Model.WorkerFunctions)
                                        {
                                            <option value="@func.WorkerFunctionId">@func.WorkerFunctionName</option>
                                        }
                                    }
                                </select>
                            </div>

                            

                            <div class="form-group">
                                <label>Name:</label>
                                <input type="text" name="workerName" value="@worker.Name" class="form-control" required />
                            </div>
                            <div class="form-group">
                                <label>SurName:</label>
                                <input type="text" name="workerSurName" value="@worker.Surname" class="form-control" required />
                            </div>
                            <div class="form-group">
                                <label>Gender:</label>
                                <select name="workerGender" class="form-control" required>
                                    @if(worker.DeclaredGender.ToString() == "Male")
                                    {
                                        <option value="77">Male</option>
                                        <option value="70">Female</option>
                                    }
                                    else
                                    {
                                        <option value="70">Female</option>
                                        <option value="77">Male</option>
                                    }
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Phone:</label>
                                <input type="text" name="workerPhone" value="@worker.PhoneNumber" class="form-control" required />
                            </div>
                            <div class="form-group">
                                <label>Email:</label>
                                <input type="text" name="workerEmail" value="@worker.Email" class="form-control" required />
                            </div>
                            <div class="form-group">
                                <label>Password:</label>
                                <input type="text" name="workerPassword" value="@worker.Password" class="form-control" required />
                            </div>

                            <button type="submit" class="btn btn-primary-warning">Save Changes</button>
                        </form>
                    </div>

                    <br>
                </tr>
            }
        }
        else
        {
            <p>Brak danych o pracownikach.</p>
        }
    </div>
    <!---------------------------------------------------------------------------------------------------->
    <div class="tab-pane fade" id="nav-price" role="tabpanel" aria-labelledby="nav-price-tab" tabindex="0">
        Nie ma takiej tabeli w BD
    </div>
    <!---------------------------------------------------------------------------------------------------->
    <div class="tab-pane fade" id="nav-passes" role="tabpanel" aria-labelledby="nav-passes-tab" tabindex="0">

        <!--ADD NEW RECORD FORM-->
        <button type="button" class="btn btn-success" data-bs-toggle="collapse" data-bs-target="#addForm-Model.PassId">Add New Record</button>
        <div id="addForm-Model.PassId" class="collapse">
            <form method="post" asp-page-handler="AddPass">
                <div class="form-group">
                    <label>Pass Type:</label>
                    <select name="passType" class="form-control" required>
                        <option value="">Select pass type</option> 
                        @if (Model.PassTypes != null && Model.PassTypes.Count > 0)
                        {
                            @foreach (var func in Model.PassTypes)
                            {
                                <option value="@func.PassTypeId">@func.PassTypeName</option>
                            }
                        }
                    </select>
                </div>
                <div class="form-group">
                    <label>User:</label>
                    <select name="selectedUser" class="form-control" required>
                        <option value="">Select user </option> 
                        @if (Model.Users != null && Model.Users.Count > 0)
                        {
                            @foreach (var user in Model.Users)
                            {
                                <option value="@user.UserId">@user.Name @user.Surname</option>
                            }
                        }
                    </select>
                </div>
                <div class="form-group mt-2">
                    <label for="PassEntriesLeft">Pass Entries Left:</label>
                    <input type="number" name="passEntriesLeft" id="passEntriesLeft" class="form-control" min="1" required />
                </div>
                <div class="form-group">
                    <label>Status:</label>
                    <select name="statusPass" class="form-control" required>
                        <option value="Pending">Pending</option>
                        <option value="Approved">Approved</option>
                        <option value="Denied">Denied</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-success">Add</button>
            </form>
        </div>

        @if (Model.Passes != null && Model.Passes.Count > 0)
        {
            @foreach (var pass in Model.Passes)
            {
                <tr>
                    <td>@pass.PassId</td>
                    <td>@pass.PassType</td>
                    <td>@pass.PassUser.Name</td>
                    <td>@pass.PassUser.Surname</td>
                    <td>@pass.PassEntriesLeft</td>
                    <td>@pass.CurrentStatus</td>

                    <!-- DELETE BUTTON -->
                    <button type="button" class="btn btn-danger" data-mdb-ripple-init data-bs-toggle="modal" data-bs-target="#confirmDeleteModalPass-@pass.PassId">Delete</button>

                    <!-- POPUP CONFIRM MENU -->
                    <div class="modal fade" id="confirmDeleteModalPass-@pass.PassId" tabindex="-1" aria-labelledby="confirmDeleteModalLabelPass-@pass.PassId" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="confirmDeleteModalLabelPass-@pass.PassId">Confirm Deletion</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    Are you sure you want to delete this item?
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                    <form method="post" id="deleteForm-@pass.PassId" asp-page-handler="DeletePass" asp-route-id="@pass.PassId" style="display:inline;">
                                        <button type="submit" id="confirmDeleteButtonPass-@pass.PassId" class="btn btn-danger">Delete</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!--EDIT BUTTON-->
                    <button type="button" class="btn btn-warning" data-toggle="collapse" data-target="#editForm-@pass.PassId">Edit</button>

                    <!--POPUP-EDIT-FORM-->
                    <div id="editForm-@pass.PassId" class="collapse">
                        <form method="post" asp-page-handler="EditPass" asp-route-id="@pass.PassId">
                            <div class="form-group">
                                <label>Pass Type:</label>
                                <select name="passType" class="form-control" required>

                                    <option value="@pass.PassType.PassTypeId" selected>
                                        @pass.PassType.PassTypeName
                                    </option>

                                    @* <option value="">Select worker AssignedAssignedWorkerFunction</option> *@
                                    @if (Model.PassTypes != null && Model.PassTypes.Count > 0)
                                    {
                                        @foreach (var func in Model.PassTypes)
                                        {
                                            <option value="@func.PassTypeId">@func.PassTypeName</option>
                                        }
                                    }
                                </select>
                            </div>
                            <div class="form-group">
                                <label>User:</label>
                                <select name="selectedUser" class="form-control" required>

                                    <option value="@pass.PassUser.UserId" selected>
                                        @pass.PassUser.Name @pass.PassUser.Surname
                                    </option>

                                    @* <option value="">Select worker AssignedAssignedWorkerFunction</option> *@
                                    @if (Model.Users != null && Model.Users.Count > 0)
                                    {
                                        @foreach (var user in Model.Users)
                                        {
                                            <option value="@user.UserId">@user.Name @user.Surname</option>
                                        }
                                    }
                                </select>
                            </div>
                            <div class="form-group mt-2">
                                <label for="PassEntriesLeft">Pass Entries Left:</label>
                                <input type="number" name="passEntriesLeft" value=@pass.PassEntriesLeft id="passEntriesLeft" class="form-control" min="1" required />
                            </div>
                            <div class="form-group">
                                <label>Status:</label>
                                <select name="statusPass" value=@pass.CurrentStatus.ToString() class="form-control" required>
                                    @if (Model.Reservations != null && Model.Reservations.Count > 0)
                                    {
                                        <option value="@pass.CurrentStatus.ToString()">@pass.CurrentStatus.ToString()</option>
                                        if ("Approved" != @pass.CurrentStatus.ToString())
                                        {
                                            <option value="Approved">Approved</option>
                                        }
                                        if ("Pending" != @pass.CurrentStatus.ToString())
                                        {
                                            <option value="Pending">Pending</option>
                                        }
                                        if ("Denied" != @pass.CurrentStatus.ToString())
                                        {
                                            <option value="Denied">Denied</option>
                                        }

                                    }
                                </select>
                            </div>

                            <button type="submit" class="btn btn-primary-warning">Save Changes</button>
                        </form>
                    </div>

                </tr>

                
            }
        }
        else
        {
            <p>Brak danych o promocjach.</p>
        }
    </div>
    <!---------------------------------------------------------------------------------------------------->
    <div class="tab-pane fade" id="nav-reservations" role="tabpanel" aria-labelledby="nav-reservations-tab" tabindex="0">

    <!-- ADD NEW RESERVATION FORM -->
    <button type="button" class="btn btn-success" data-bs-toggle="collapse" data-bs-target="#addReservationForm">Add New Reservation</button>
    <div id="addReservationForm" class="collapse">
        <form method="post" asp-page-handler="AddReservation">
                <div class="form-group">
                    <label>Facility:</label>
                    <select name="facilityId" class="form-control" required>
                        <option value="">Select Facility</option>
                        @if (Model.Facilities != null && Model.Facilities.Count > 0)
                        {
                            @foreach (var facility in Model.Facilities)
                            {
                                <option value="@facility.FacilityId">@facility.FacilityName (@facility.FacilityId)</option>
                            }
                        }
                    </select>
                </div>
                <div class="form-group">
                    <label>User:</label>
                    <select name="userId" class="form-control" required>
                        <option value="">Select User</option>
                        @if (Model.Users != null && Model.Users.Count > 0)
                        {
                            @foreach (var user in Model.Users)
                            {
                                <option value="@user.UserId">@user.Name @user.Surname (@user.UserId)</option>
                            }
                        }
                    </select>
                </div>
                <div class="form-group">
                    <label>Reservation Date:</label>
                    <input type="date" name="resDate" id="reservationDateDay" class="form-control" required />
                    <select id="reservationTime" name="resTime" class="form-control" required>
                        <option value="09:00">09:00</option>
                        <option value="10:00">10:00</option>
                        <option value="11:00">11:00</option>
                        <option value="12:00">12:00</option>
                        <option value="13:00">13:00</option>
                        <option value="14:00">14:00</option>
                        <option value="15:00">15:00</option>
                        <option value="16:00">16:00</option>
                        <option value="17:00">17:00</option>
                        <option value="18:00">18:00</option>
                        <option value="19:00">19:00</option>
                        <option value="20:00">20:00</option>
                        <option value="21:00">21:00</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Status:</label>
                    <select name="status" class="form-control" required>
                        <option value="Pending">Pending</option>
                        <option value="Approved">Approved</option>
                        <option value="Denied">Denied</option>
                    </select>
                </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" name="isChangingRoomReserved" /> Is Changing Room Reserved
                </label>
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" name="isEquipmentReserved" /> Is Equipment Reserved
                </label>
            </div>
            <button type="submit" class="btn btn-success">Add</button>
        </form>
    </div>
    <br>

    <!-- LIST RESERVATIONS -->
    @if (Model.Reservations != null && Model.Reservations.Count > 0)
    {
        @foreach (var res in Model.Reservations)
        {
            <tr>
                <td>@res.ReservationId</td>
                <td>@res.ReservationFacility.FacilityId</td>
                <td>@res.ReservationUser.UserId</td>
                <td>@res.ReservationDate</td>
                <td>@res.CurrentStatus</td>
                <td>@res.Cost.ToString("C", new System.Globalization.CultureInfo("pl-PL"))</td>

                    <!-- DELETE BUTTON -->
                    <button type="button" class="btn btn-danger" data-mdb-ripple-init data-bs-toggle="modal" data-bs-target="#confirmDeleteModalR-@res.ReservationId">Delete</button>

                    <!-- POPUP CONFIRM MENU -->
                    <div class="modal fade" id="confirmDeleteModalR-@res.ReservationId" tabindex="-1" aria-labelledby="confirmDeleteModalLabelR-@res.ReservationId" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="confirmDeleteModalLabelR-@res.ReservationId">Confirm Deletion</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    Are you sure you want to delete this item?
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                    <form method="post" id="deleteForm-@res.ReservationId" asp-page-handler="DeleteReservation" asp-route-id="@res.ReservationId" style="display:inline;">
                                        <button type="submit" id="confirmDeleteButtonR-@res.ReservationId" class="btn btn-danger">Delete</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                <!-- EDIT BUTTON -->
                <button type="button" class="btn btn-warning" data-toggle="collapse" data-target="#editForm-@res.ReservationId">Edit</button>

                <!-- EDIT FORM -->
                <div id="editForm-@res.ReservationId" class="collapse">
                    <form method="post" asp-page-handler="EditReservation" asp-route-id="@res.ReservationId">
                        <div class="form-group">
                            <label>Facility:</label>
                            <select name="facilityId" class="form-control" required>
                                    <option value="@res.ReservationFacility.FacilityId">@res.ReservationFacility.FacilityName</option>
                                @if (Model.Facilities != null && Model.Facilities.Count > 0)
                                {
                                    @foreach (var facility in Model.Facilities)
                                    {
                                        <option value="@facility.FacilityId">@facility.FacilityName (@facility.FacilityId)</option>
                                    }
                                }
                            </select>
                        </div>
                        <div class="form-group">
                            <label>User:</label>
                            <select name="userId" class="form-control" required>
                                    <option value="res.ReservationUser?.UserId">@res.ReservationUser.Name @res.ReservationUser.Surname </option>
                                @if (Model.Users != null && Model.Users.Count > 0)
                                {
                                    @foreach (var user in Model.Users)
                                    {
                                        <option value="@user.UserId">@user.Name @user.Surname (@user.UserId)</option>
                                    }
                                }
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Reservation Date:</label>
                                <input type="datetime-local" name="reservationDate" value="@res.ReservationDate.ToString("yyyy-MM-ddTHH:mm")" class="form-control" required />
                        </div>
                            <div class="form-group">
                                <label for="facilityType">Status:</label>
                                <select name="status" id="status" value="@res.CurrentStatus.ToString()" class="form-control" required>
                                    @if (Model.Reservations != null && Model.Reservations.Count > 0)
                                    {
                                        <option value="@res.CurrentStatus.ToString()">@res.CurrentStatus.ToString()</option>
                                        if ("Approved" != @res.CurrentStatus.ToString())
                                        {
                                            <option value="Approved">Approved</option>
                                        }
                                        if ("Pending" != @res.CurrentStatus.ToString())
                                        {
                                            <option value="Pending">Pending</option>
                                        }
                                        if ("Denied" != @res.CurrentStatus.ToString())
                                        {
                                            <option value="Denied">Denied</option>
                                        }

                                    }
                                </select>
                            </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" name="isChangingRoomReserved" @(res.IsChangingRoomReserved ? "checked" : "") /> Is Changing Room Reserved
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" name="isEquipmentReserved" @(res.IsEquipmentReserved ? "checked" : "") /> Is Equipment Reserved
                            </label>
                        </div>
                        <button type="submit" class="btn btn-primary-warning">Save Changes</button>
                    </form>
                </div>

                <br>
            </tr>
        }
    }
    else
    {
        <p>Brak danych o rezerwacjach.</p>
    }
</div>


    <div class="tab-pane fade" id="nav-workerSession" role="tabpanel" aria-labelledby="nav-workerSession-tab" tabindex="0">
        <!-- Widok lAAAAAAAAAAAAAAAAAAAAAAAAAisAAAAAAAAAAAAAAAAAAAAisAAAAAAAAAAAAAAAAAAAAisAAAAAAAAAAAAAAAAAAAAisAAAAAAAAAAAAAAAAAAAAisAAAAAAAAAAAAAAAAAAAAisAAAAAAAAAAAAAAAAAAAAisAAAAAAAAAAAAAAAAAAAAisAAAAAAAAAAAAAAAAAAAAisAAAAAAAAAAAAAAAAAAAAisAAAAAAAAAAAAAAAAAAAAisAAAAAAAAAAAAAAAAAAAAisty ośrodków -->
            @if (!Model.SelectedCenterId.HasValue)
    {
        <!-- Widok listy ośrodków -->
        <h2 class="text-center mb-4">Available Sports Centers</h2>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4 mb-3">
            @foreach (var center in Model.SportsCenters)
            {
                <div class="col">
                    <div class="card h-100 shadow-sm">
                        <div class="card-body">
                            <h5 class="card-title text-center">@center.Name</h5>
                            <div class="d-flex justify-content-center mt-3">
                                    <a class="btn btn-primary"
                                       asp-page="/AdminPanel"
                                       asp-route-centerId="@center.SportsCenterId"
                                       asp-route-tab="workerSession">
                                        View Facilities
                                    </a>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
    else if (!Model.SelectedObjectId.HasValue)
    {
        <!-- Widok obiektów sportowych dla wybranego ośrodka -->
        <h2 class="text-center mb-4">Facilities in <span class="text-primary">@Model.SelectedCenterName</span></h2>
        @if (Model.Facilities.Any())
        {
            <div class="list-group mb-3">
                @foreach (var facility in Model.Facilities)
                {
                    <a class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
                           asp-page="/AdminPanel"
                           asp-route-centerId="@Model.SelectedCenterId" 
                       asp-route-objectId="@facility.FacilityId"
                           asp-route-tab="workerSession">
                        @facility.FacilityName
                        <span class="badge bg-primary">View Calendar</span>
                    </a>
                }
            </div>
        }
        else
        {
            <div class="alert alert-warning text-center" role="alert">
                No facilities available for this center.
            </div>
        }
    }
    else
    {
        <div class="container">
            <div class="row my-4">
                <!-- Sekcja kalendarza po lewej -->
                <div class="col-md-3">
                    <h3 class="mb-3">Select a Day</h3>
                    <form method="post" asp-page-handler="ChangeDate">
                        <input type="hidden" name="SelectedCenterId" value="@Model.SelectedCenterId" />
                        <input type="hidden" name="SelectedObjectId" value="@Model.SelectedObjectId" />
                        <input id="startDate"
                               class="form-control"
                               style="max-width: 180px;"
                               type="date"
                               name="SelectedDay"
                               value="@Model.SelectedDay"
                               min="@Model.MinDate"
                               max="@Model.MaxDate"
                               onchange="this.form.submit();" />
                    </form>
                </div>

                <!-- Sekcja godzin na środku -->
                <div class="row">
                    <div class="col-md-6">
                        <h3 class="text-center mb-3">Hours for <span id="selected-day" class="text-primary">@Model.SelectedDay</span></h3>
                        <ul class="list-group">
                            @for (int hour = 9; hour <= 20; hour++)
                            {
                               @*  bool isTaken = Model.OccupiedHours.Contains(hour);

                                DateTime selectedDate = DateTime.Parse(Model.SelectedDay);
                                DateTime currentDate = DateTime.Now.Date;

                                bool isPastDate = selectedDate < currentDate;
                                bool isToday = selectedDate == currentDate;
                                bool isPastHour = isToday && hour <= DateTime.Now.Hour; *@

                                    var slotKeyByUser = $"{Model.SelectedCenterId} {Model.SelectedObjectId} {Model.SelectedDay} {hour:00} U";
                                    var slotKeyByWorker = $"{Model.SelectedCenterId} {Model.SelectedObjectId} {Model.SelectedDay} {hour:00} W";
                                    bool isTakenByUser = Model.TakenSlots.Contains(slotKeyByUser);
                                    bool isTakenByWorker = Model.TakenSlots.Contains(slotKeyByWorker);
                                    // Sprawdzenie, czy godzina jest przeszła w bieżącym dniu
                                    bool isPastHour = Model.SelectedDay == DateTime.Now.ToString("yyyy-MM-dd") && hour <= DateTime.Now.Hour;

                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    @hour:00 - @hour:59
                                    <div>
                                            @if (isTakenByWorker)
                                        {
                                                
                                                
                                                    <form method="post" asp-page-handler="EditFormState" asp-page="/AdminPanel"
                                                    asp-route-centerId="@Model.SelectedCenterId"
                                                    asp-route-objectId="@Model.SelectedObjectId">
                                                        <input type="hidden" name="selectedHour" value="@hour" />
                                                        <input type="hidden" name="selectedDay" value="@Model.SelectedDay" />
                                                        <button type="submit" class="btn btn-danger btn-sm">Check</button>
                                                </form>

                                            }
                                            else if (isTakenByUser)
                                            {
                                                <button class="btn btn-secondary btn-sm" disabled>Taken by User</button>
                                            }
                                            else if (isPastHour)
                                        {
                                            <button class="btn btn-secondary btn-sm" disabled>Expired</button>
                                        }
                                        else
                                        {
                                            <!-- Przy kliknięciu przekazujemy wybraną datę i godzinę -->
                                                <form method="post" asp-page-handler="ChangeFormState" asp-page="/AdminPanel"
                                                      asp-route-centerId="@Model.SelectedCenterId"
                                                      asp-route-objectId="@Model.SelectedObjectId">
                                                <input type="hidden" name="selectedHour" value="@hour" />
                                                <input type="hidden" name="selectedDay" value="@Model.SelectedDay" />
                                                <button type="submit" class="btn btn-success btn-sm">Add</button>
                                            </form>
                                        }
                                    </div>
                                </li>
                            }
                        </ul>
                    </div>
                    @if (Model.IsAddFormVisible == "Adding")
                    {
                        <div class="col-md-6">
                            <div id="addForm" class="static-form">
                                <h4 class="mb-3">Add Training Session</h4>
                                <form method="post" asp-page-handler="AddTrainingSession">
                                    <div class="form-group">
                                        <label for="FacilityId">Facility:</label>
                                        <select name="FacilityId" id="FacilityId" class="form-control" required>
                                            <option value="">Select Facility</option>
                                            @if (Model.Facilities != null && Model.Facilities.Count > 0)
                                            {
                                                @foreach (var facility in Model.Facilities)
                                                {
                                                    <option value="@facility.FacilityId">@facility.FacilityName</option>
                                                }
                                            }
                                        </select>
                                    </div>
                                    <div class="form-group mt-2">
                                        <label for="Trainer">Trainer:</label>
                                        @if (Model.Permissions == 1)
                                        {
                                            <select name="TrainerId" id="TrainerId" class="form-control" required>
                                                <option value="">Select Trainer</option>
                                                @if (Model.Workers != null && Model.Workers.Count > 0)
                                                {
                                                    @foreach (var worker in Model.Workers.Where(w => w.AssignedWorkerFunction.WorkerFunctionId == 3))
                                                    {
                                                        <option value="@worker.WorkerId">@worker.Name @worker.Surname</option>
                                                    }
                                                }
                                                }
                                            </select>
                                        }
                                        else
                                        {
                                            <input type="hidden" name="TrainerId" value="@Model.perms.WorkerId" />
                                            <input type="text" class="form-control" value="@Model.perms.Name @Model.perms.Surname" readonly />
                                        }
                                    </div>
                                    <div class="form-group mt-2">
                                        <label for="Name">Training Name:</label>
                                        <input type="text" name="Name" id="Name" class="form-control" maxlength="50" required />
                                    </div>
                                    <div class="form-group mt-2">
                                        <label for="Date">Date:</label>
                                        <input type="datetime-local"
                                               name="Date"
                                               id="Date"
                                               class="form-control"
                                               value="@($"{Model.SelectedDay}T{Model.SelectedHour:D2}:00")"
                                               readonly />
                                    </div>
                                    <div class="form-group mt-2">
                                        <label for="Duration">Duration (minutes):</label>
                                        <input type="number" name="Duration" id="Duration" class="form-control" min="1" required />
                                    </div>
                                    <div class="form-group mt-2">
                                        <label for="GroupCapacity">Group Capacity:</label>
                                        <input type="number" name="GroupCapacity" id="GroupCapacity" class="form-control" min="1" required />
                                    </div>
                                    <button type="submit" class="btn btn-success mt-3">Submit</button>
                                </form>
                            </div>
                        </div>
                    }
                        else if (Model.IsAddFormVisible == "Edit" && (Model.Permissions == 1 || Model.EditingWorkerSession.AssignedWorker.WorkerId == @Model.perms.WorkerId))
                    {
                        <div class="col-md-6">
                            <div id="editForm" class="static-form">
                                <h4 class="mb-3">Edit Training Session</h4>
                                <form method="post" asp-page-handler="EditTrainingSession" asp-route-id="@Model.EditingWorkerSession.TrainingSession.TrainingSessionId">
                                    <div class="form-group">
                                        <label for="FacilityId">Facility:</label>
                                            <select name="FacilityId" id="FacilityId" class="form-control" required>
                                            <!-- Domyślna wartość -->
                                            <option value="@Model.EditingWorkerSession.TrainingSession.Facility.FacilityId" >
                                                                        @Model.EditingWorkerSession.TrainingSession.Facility.FacilityName
                                            </option>
                                            <!-- Inne dostępne opcje -->
                                            
                                            @if (Model.Facilities != null && Model.Facilities.Count > 0)
                                            {
                                                @foreach (var facility in Model.Facilities.Where(f => f.FacilityId != Model.EditingWorkerSession.TrainingSession.Facility.FacilityId))
                                                {
                                                    <option value="@facility.FacilityId">@facility.FacilityName</option>
                                                }
                                            }
                                            </select>
                                    </div>
                                    <div class="form-group mt-2">
                                        <label for="TrainerId">Trainer:</label>
                                        <select name="TrainerId" id="TrainerId" class="form-control" required>
                                            <!-- Domyślna wartość -->
                                            <option value="@Model.EditingWorkerSession.AssignedWorker.WorkerId" selected>
                                                @Model.EditingWorkerSession.AssignedWorker.Name @Model.EditingWorkerSession.AssignedWorker.Surname
                                            </option>
                                            <!-- Inne dostępne opcje, jeśli użytkownik ma odpowiednie uprawnienia -->
                                            @if (Model.Permissions == 1 && Model.Workers != null && Model.Workers.Count > 0)
                                            {
                                                @foreach (var worker in Model.Workers.Where(w => w.AssignedWorkerFunction.WorkerFunctionId == 3 && w.WorkerId != Model.EditingWorkerSession.AssignedWorker.WorkerId))
                                                {
                                                    <option value="@worker.WorkerId">@worker.Name @worker.Surname</option>
                                                }
                                            }
                                        </select>
                                    </div>

                                <div class="form-group mt-2">
                                    <label for="Name">Training Name:</label>
                                    <input type="text" name="Name" id="Name" class="form-control" value="@Model.EditingWorkerSession.TrainingSession.Name" maxlength="50" required />
                                </div>
                                <!-- Date -->
                                <div class="form-group mt-2">
                                    <label for="Date">Date:</label>
                                    <input type="datetime-local"
                                           name="Date"
                                           id="Date"
                                           class="form-control"
                                           value="@Model.EditingWorkerSession.TrainingSession.Date.ToString("yyyy-MM-ddTHH:mm")"
                                           required />
                                </div>
                                    <div class="form-group mt-2">
                                        <label for="GroupCapacity">Group Capacity:</label>
                                        <input type="number" name="GroupCapacity" id="GroupCapacity" class="form-control" value="@Model.EditingWorkerSession.TrainingSession.GroupCapacity" min="1" required />
                                    </div>
                                    <button type="submit" class="btn btn-primary mt-3">Submit</button>
                                    <button type="button" class="btn btn-danger" data-mdb-ripple-init data-bs-toggle="modal" data-bs-target="#confirmDeleteModalTM-@Model.EditingWorkerSession.TrainingSession.TrainingSessionId-@Model.EditingWorkerSession.AssignedWorker.WorkerId">Delete</button>
                                    </form>
                            </div>
                        </div>

                            <!-- DELETE BUTTON -->
                            
                            <!-- POPUP CONFIRM MENU -->
                            <div class="modal fade" id="confirmDeleteModalTM-@Model.EditingWorkerSession.TrainingSession.TrainingSessionId-@Model.EditingWorkerSession.AssignedWorker.WorkerId" tabindex="-1" aria-labelledby="confirmDeleteModalLabelTM-@Model.EditingWorkerSession.TrainingSession.TrainingSessionId-@Model.EditingWorkerSession.AssignedWorker.WorkerId" aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="confirmDeleteModalLabelTM-@Model.EditingWorkerSession.TrainingSession.TrainingSessionId-@Model.EditingWorkerSession.AssignedWorker.WorkerId">Confirm Deletion</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            Are you sure you want to delete this item?
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                            <form method="post" asp-page-handler="DeleteWorkerTrainingSession">
                                                <input type="hidden" name="sessionid" value="@Model.EditingWorkerSession.TrainingSession.TrainingSessionId" />
                                                <input type="hidden" name="workerid" value="@Model.EditingWorkerSession.AssignedWorker.WorkerId" />
                                                <button type="submit" class="btn btn-danger">Delete</button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>


                            
                    }
                </div>

            </div>
        </div>
        }
    </div>
















    @* <div class="tab-pane fade" id="nav-workerSession" role="tabpanel" aria-labelledby="nav-workerSession-tab" tabindex="0">
        <div class="container">
            <div class="row my-4">
                <!-- Sekcja kalendarza po lewej -->
                <div class="col-md-3">
                    <h3 class="mb-3">Select a Day</h3>
                    <form method="get" asp-page-handler="ChangeDate">
                        <input type="hidden" name="SelectedCenterId" value="@Model.SelectedCenterId" />
                        <input type="hidden" name="SelectedObjectId" value="@Model.SelectedObjectId" />
                        <input id="startDate"
                               class="form-control"
                               style="max-width: 180px;"
                               type="date"
                               name="SelectedDay"
                               value="@Model.SelectedDay"
                               min="@Model.MinDate"
                               max="@Model.MaxDate"
                               onchange="this.form.submit();" />
                    </form>
                </div>

                <!-- Sekcja godzin na środku -->
                <div class="col-md-5">
                    <h3 class="mb-3">Hours for <span class="text-primary">@Model.SelectedDay</span></h3>
                    <ul class="list-group">
                        @for (int hour = 9; hour <= 20; hour++)
                        {
                            bool isTaken = Model.OccupiedHours.Contains(hour);

                            // Sprawdzenie, czy godzina jest przeszła w bieżącym dniu
                            DateTime selectedDate = DateTime.Parse(Model.SelectedDay);
                            DateTime currentDate = DateTime.Now.Date;

                            bool isPastDate = selectedDate < currentDate;
                            bool isToday = selectedDate == currentDate;
                            bool isPastHour = isToday && hour <= DateTime.Now.Hour;

                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                @hour:00 - @hour:59
                                <div>
                                    @if (isTaken)
                                    {
                                        <button class="btn btn-danger btn-sm">Check</button>
                                    }
                                    else if (isPastDate || isPastHour)
                                    {
                                        <button class="btn btn-secondary btn-sm" disabled>Expired</button>
                                    }
                                    else
                                    {
                                        <button class="btn btn-success btn-sm" onclick="showForm('@hour', '@Model.SelectedDay')">Add</button>
                                    }
                                </div>
                            </li>
                        }
                    </ul>
                </div>

                <!-- Sekcja formularza po prawej -->
                <div class="col-md-4" id="formContainer" style="display: none;">
                    <h3 class="mb-3">Add Training Session</h3>
                    <form method="post" asp-page-handler="AddTrainingSession">
                        <div class="form-group">
                            <label for="FacilityId">Facility:</label>
                            <select name="FacilityId" id="FacilityId" class="form-control" required>
                                <option value="">Select Facility</option>
                                @if (Model.Facilities != null && Model.Facilities.Count > 0)
                                {
                                    @foreach (var facility in Model.Facilities)
                                    {
                                        <option value="@facility.FacilityId">@facility.FacilityName</option>
                                    }
                                }
                            </select>
                        </div>
                        <div class="form-group mt-2">
                            <label for="Trainer">Trainer:</label>
                            @if (Model.Permissions == 1)
                            {
                                <select name="TrainerId" id="TrainerId" class="form-control" required>
                                    <option value="">Select Trainer</option>
                                    @if (Model.Workers != null && Model.Workers.Count > 0)
                                    {
                                        @foreach (var worker in Model.Workers.Where(w => w.AssignedWorkerFunction.WorkerFunctionId == 2))
                                        {
                                            <option value="@worker.WorkerId">@worker.Name @worker.Surname</option>
                                        }
                                    }
                                    }
                                </select>
                            }
                            else
                            {
                                <input type="hidden" name="TrainerId" value="@Model.perms.WorkerId" />
                                <input type="text" class="form-control" value="@Model.perms.Name @Model.perms.Surname" readonly />
                            }
                        </div>
                        <div class="form-group mt-2">
                            <label for="Name">Training Name:</label>
                            <input type="text" name="Name" id="Name" class="form-control" maxlength="50" required />
                        </div>
                        <div class="form-group mt-2">
                            <label for="Date">Date:</label>
                            <input type="datetime-local" name="Date" id="Date" class="form-control" required />
                        </div>
                        <div class="form-group mt-2">
                            <label for="Duration">Duration (minutes):</label>
                            <input type="number" name="Duration" id="Duration" class="form-control" value="0" readonly />
                        </div>
                        <div class="form-group mt-2">
                            <label for="GroupCapacity">Group Capacity:</label>
                            <input type="number" name="GroupCapacity" id="GroupCapacity" class="form-control" min="1" required />
                        </div>
                        <button type="submit" class="btn btn-success mt-3">Add</button>
                    </form>
                </div>
            </div>
        </div>
    </div> *@

    



        <!-- ADD NEW RECORD FORM -->
        <!-- ADD NEW TRAINING SESSION FORM -->
        @* @* @* <button type="button" class="btn btn-success" data-bs-toggle="collapse" data-bs-target="#addForm-TrainingSession">Add New Training Session</button>
        <div id="addForm-TrainingSession" class="collapse mt-3">
            <form method="post" asp-page-handler="AddTrainingSession">
                <div class="form-group">
                    <label for="FacilityId">Facility:</label>
                    <select name="FacilityId" id="FacilityId" class="form-control" required>
                        <option value="">Select Facility</option>
                        @if (Model.Facilities != null && Model.Facilities.Count > 0)
                        {
                            @foreach (var facility in Model.Facilities)
                            {
                                <option value="@facility.FacilityId">@facility.FacilityName</option>
                            }
                        }
                    </select>
                </div>
                <div class="form-group mt-2">
                    <label for="Trainer">Trainer:</label>
                    @if (Model.Permissions == 1)
                    {
                        <select name="TrainerId" id="TrainerId" class="form-control" required>
                            <option value="">Select Trainer</option>
                            @if (Model.Workers != null && Model.Workers.Count > 0)
                            {
                                @foreach (var worker in Model.Workers.Where(w => w.AssignedWorkerFunction.WorkerFunctionId == 2))
                                {
                                    <option value="@worker.WorkerId">@worker.Name @worker.Surname</option>
                                }
                            }
                        </select>
                    }
                    else
                    {
                        <input type="hidden" name="TrainerId" value="@Model.perms.WorkerId" />
                        <input type="text" class="form-control" value="@Model.perms.Name @Model.perms.Surname" readonly />
                    }
                </div>
                <div class="form-group mt-2">
                    <label for="Name">Training Name:</label>
                    <input type="text" name="Name" id="Name" class="form-control" maxlength="50" required />
                </div>
                <div class="form-group mt-2">
                    <label for="Date">Date:</label>
                    <input type="datetime-local" name="Date" id="Date" class="form-control" required />
                </div>
                <div class="form-group mt-2">
                    <label for="Duration">Duration (minutes):</label>
                    <input type="number" name="Duration" id="Duration" class="form-control" min="1" required />
                </div>
                <div class="form-group mt-2">
                    <label for="GroupCapacity">Group Capacity:</label>
                    <input type="number" name="GroupCapacity" id="GroupCapacity" class="form-control" min="1" required />
                </div>
                <button type="submit" class="btn btn-success mt-3">Add</button>
            </form>
        </div>

        @if (Model.WorkerTrainingSessions != null && Model.WorkerTrainingSessions.Count > 0)
        {
            @foreach (var trainingSession in Model.WorkerTrainingSessions)
            {
                <tr>
                    <td>@trainingSession.TrainingSession.TrainingSessionId</td>
                    <td>@trainingSession.AssignedWorker.WorkerId</td>
                    <td>@trainingSession.TrainingSession.Name</td>
                    <td>@trainingSession.TrainingSession.Date</td>
                    <td>@trainingSession.TrainingSession.Duration</td>
                    <td>@trainingSession.TrainingSession.GroupCapacity</td>
                    <button type="button" class="btn btn-danger" data-mdb-ripple-init>Delete</button>
                    <!--EDIT BUTTON-->
                    @* <button type="button" class="btn btn-warning" data-toggle="collapse" data-target="#editForm-@trainingSession.TrainingSessionId">Edit</button>

                    <!--POPUP-EDIT-FORM-->
                    <div id="editForm-@trainingSession.TrainingSessionId" class="collapse">
                        <form method="post" asp-page-handler="EditTrainingSession" asp-route-id="@trainingSession.TrainingSessionId">
                            <div class="form-group">
                                <label for="FacilityId">Facility:</label>
                                <select name="FacilityId" class="form-control" required>
                                    @if (Model.Facilities != null && Model.Facilities.Count > 0)
                                    {
                                        @foreach (var facility in Model.Facilities)
                                        {
                                            <option value="@facility.FacilityId" @(facility.FacilityId == trainingSession.Facility.FacilityId ? "selected" : "")>
                                                @facility.Name
                                            </option>
                                        }
                                    }
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="Name">Training Name:</label>
                                <input type="text" name="Name" value="@trainingSession.Name" class="form-control" required />
                            </div>
                            <div class="form-group">
                                <label for="Date">Date:</label>
                                <input type="datetime-local" name="Date" value="@trainingSession.Date.ToString("yyyy-MM-ddTHH:mm")" class="form-control" required />
                            </div>
                            <div class="form-group">
                                <label for="Duration">Duration (minutes):</label>
                                <input type="number" name="Duration" value="@trainingSession.Duration" class="form-control" min="1" required />
                            </div>
                            <div class="form-group">
                                <label for="GroupCapacity">Group Capacity:</label>
                                <input type="number" name="GroupCapacity" value="@trainingSession.GroupCapacity" class="form-control" min="1" required />
                            </div>
                            <div class="form-group">
                                <label for="TrainerId">Trainer:</label>
                                @if (Model.Permissions == 1)
                                {
                                    <select name="TrainerId" class="form-control" required>
                                        @foreach (var worker in Model.Workers.Where(w => w.AssignedWorkerFunction.WorkerFunctionId == 2))
                                        {
                                            <option value="@worker.WorkerId" @(worker.WorkerId == trainingSession.Trainer.WorkerId ? "selected" : "")>
                                                @worker.Name @worker.Surname
                                            </option>
                                        }
                                    }
                                    </select>
                                }
                                else
                                {
                                    <input type="hidden" name="TrainerId" value="@Model.Perms.WorkerId" />
                                    <input type="text" class="form-control" value="@Model.Perms.Name @Model.Perms.Surname" readonly />
                                }
                            </div>
                            <button type="submit" class="btn btn-primary-warning">Save Changes</button>
                        </form>
                    </div> 

                    <br>
                </tr>
            }
        }
        else
        {
            <p>Brak danych o rezerwacjach.</p>
        } *@ 
    </div>


    <!---------------------------------------------------------------------------------------------------->
</div>
<!-- Skrypt do symulacji kliknięcia -->
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // Pobierz wartość ActiveTab z Razor
        const activeTab = "@Model.ActiveTab";

        // Znajdź odpowiedni przycisk i kliknij go
        if (activeTab === "workerSession") {
            document.getElementById("nav-workerSession-tab").click();
        } else if (activeTab === "sportscenter") {
            document.getElementById("nav-sportscenter-tab").click();
        }
        // Dodaj więcej przypadków, jeśli masz inne zakładki
    });
</script>